(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3576],{8801:function(e,s,l){Promise.resolve().then(l.bind(l,5795))},5795:function(e,s,l){"use strict";l.d(s,{default:function(){return h}});var t=l(7437),a=l(1444),r=l(8771),n=l(724),i=l(6463);function c(e){let{title:s,onClick:l}=e,c=(0,a.I0)(),o=(0,n.w)(1),d=(0,i.useRouter)(),{products:u,sub_total:m,delivery_fee:p,taxes:v,total:x}=function(e){let s=(0,a.v9)(e=>{let s=Object.keys(e.cart.cart),l=[];for(let a=0;a<s.length;a++)if(e.cart.products.hasOwnProperty(s[a])){var t;let r={...e.cart.products[s[a]]};r.quantity=(null===(t=e.cart.cart[s[a]])||void 0===t?void 0:t.quantity)||1,r.quantity=r.quantity<0?0:r.quantity,l.push(r)}return l});{let e=s.reduce((e,s)=>e+s.price*s.quantity,0);return{products:s,sub_total:Number(e).toFixed(2),delivery_fee:Number(2).toFixed(2),taxes:Number(1).toFixed(2),total:Number(e+2+1).toFixed(2)}}}(0),h=e=>{let s="order-".concat(Math.round(1e10*Math.random())),l={};l[s]={order_id:s,products:u,total:x,sub_total:m,delivery_fee:p,taxes:v,...e},c((0,r.s1)(l)),setTimeout(()=>{c((0,r.UY)()),setTimeout(()=>{d.push("".concat(o,"/order-tracking"))},390)},590)};return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"border bg-white shadow rounded-lg p-8",children:[(0,t.jsxs)("div",{className:"",children:[(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("div",{className:"",children:"Sub Total"}),(0,t.jsxs)("div",{className:"",children:["$",m]})]})}),(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("div",{className:"",children:"Delivery Fee"}),(0,t.jsxs)("div",{className:"",children:["$",p]})]})})]}),(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("div",{className:"",children:"Taxes"}),(0,t.jsxs)("div",{className:"",children:["$",v]})]})}),(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("div",{className:"",children:"Estimated Total"}),(0,t.jsxs)("div",{className:"",children:["$",x]})]})}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)("button",{onClick:()=>{let{valid:e,values:s}=l();e&&h(s)},className:"flex items-center justify-center rounded-full w-full overflow-hidden border px-4 py-2 ",children:s})}),(0,t.jsx)("div",{className:""})]})]})})}var o=l(6934),d=l(9772),u=l(4518),m=l(2265);function p(e){let{children:s,setSelectedCard:l}=e,r=(0,a.v9)(e=>e.account.cards),[n,i]=(0,m.useState)(r.length>0?"0":"-1");return(0,m.useEffect)(()=>{},[n]),(0,t.jsxs)("div",{className:"",children:[(0,t.jsx)("div",{className:"text-2xl my-6",children:"Card Details"}),(0,t.jsxs)("div",{className:"my-6",children:[r.map((e,s)=>(0,t.jsxs)("label",{className:"flex gap-4 px-4 py-2 my-2",onClick:()=>{i("".concat(s)),l(e)},children:[(0,t.jsx)(u.Z,{name:"card",value:"".concat(s)}),(0,t.jsxs)("div",{className:"flex-1 w-full flex gap-2 items-center",children:["visa"==e.type?(0,t.jsx)("img",{src:"/visa.png"}):(0,t.jsx)("img",{src:"/master-card.png"}),(0,t.jsx)("div",{className:"",children:"XXXX-XXXX-XXXX-".concat(e.card_number.slice(-4))})]}),(0,t.jsx)("div",{className:"flex items-center gap-2"})]},"k-".concat(s))),(0,t.jsxs)("label",{className:"flex gap-4 px-4 py-2 my-2",onClick:()=>{i("-1"),l(null)},children:[(0,t.jsx)(u.Z,{name:"card",value:"-1",checked:0==r.length}),(0,t.jsx)("div",{className:"flex-1 w-full flex gap-2 items-center",children:(0,t.jsx)("div",{className:"",children:"Add new card"})})]})]}),(0,t.jsx)("div",{className:"px-4 mb-12",children:"-1"==n?s:null})]})}function v(e){let{children:s,setSelectedBilling:l}=e,r=(0,a.v9)(e=>e.account.addresses),[n,i]=(0,m.useState)(r.length>0?"0":"-1");return(0,t.jsxs)("div",{className:"",children:[(0,t.jsx)("div",{className:"text-2xl my-6",children:"Billing Address"}),(0,t.jsxs)("div",{className:"my-6",children:[r.map((e,s)=>(0,t.jsxs)("label",{className:"flex gap-4 px-4 py-2 my-2",onClick:()=>{i("".concat(s)),l(e)},children:[(0,t.jsx)(u.Z,{name:"address",value:"".concat(s)}),(0,t.jsx)("div",{className:"flex-1 w-full flex gap-2 items-center",children:(0,t.jsx)("div",{className:"",children:"".concat(e.first_name)})}),(0,t.jsx)("div",{className:"flex items-center gap-2"})]},"k-".concat(s))),(0,t.jsxs)("label",{className:"flex gap-4 px-4 py-2 my-2",onClick:()=>{i("-1"),l(null)},children:[(0,t.jsx)(u.Z,{name:"address",value:"-1",checked:0==r.length}),(0,t.jsx)("div",{className:"flex-1 w-full flex gap-2 items-center",children:(0,t.jsx)("div",{className:"",children:"Add new address"})})]})]}),(0,t.jsx)("div",{className:"px-4 mb-12",children:"-1"==n?s:null})]})}let x=[{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"Username should only contain letters."}),component:"",defaultValue:"",slug:"country",name:"country",props:{placeholder:"Country"},type:"select",options:[{name:"",value:""},{name:"",value:""}]},{type:"inputgroup",containerClassNames:"flex gap-2 ",classNames:"w-full",children:[{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"Username should only contain letters."}),component:"",defaultValue:"",slug:"first_name",name:"First Name",props:{placeholder:"First Name"},type:"textinput"},{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"Username should only contain letters."}),component:"",defaultValue:"",slug:"last_name",name:"Last Name",props:{placeholder:"Last Name"},type:"textinput"}]},{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"Username should only contain letters."}),component:"",defaultValue:"",slug:"street_address",name:"Street Address",props:{placeholder:"Street Address"},type:"textarea"},{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"Username should only contain letters."}),component:"",defaultValue:"",slug:"address",name:"Address",props:{placeholder:"Address"},type:"textarea"},{validator:d.z.string(),component:"",defaultValue:"",slug:"po_box",name:"PO Box",props:{children:"PO Box"},type:"checkbox"},{type:"inputgroup",containerClassNames:"flex gap-2 ",classNames:"w-full",children:[{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"Username should only contain letters."}),component:"",defaultValue:"",slug:"city",name:"City",props:{placeholder:"City"},type:"textinput"},{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"Username should only contain letters."}),component:"",defaultValue:"",slug:"province",name:"Province",props:{placeholder:"Province"},type:"textinput"}]},{type:"inputgroup",containerClassNames:"flex gap-2 ",classNames:"w-full",children:[{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"Username should only contain letters."}),component:"",defaultValue:"",slug:"postal_code",name:"Postal Code",props:{placeholder:"Postal Code"},type:"textinput"},{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"Username should only contain letters."}),component:"",defaultValue:"",slug:"mobile_number",name:"Mobile Number",props:{placeholder:"Mobile Number"},type:"textinput"}]}];function h(){let[e,s]=(0,m.useState)(void 0),[l,r]=(0,m.useState)(void 0);(0,i.useRouter)();let n=[{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"Username should only contain letters."}),component:"",defaultValue:"",slug:"card_number",name:"Card Number",props:{placeholder:"XXXX-XXXX-XXXX-XXXX"},type:"textinput"},{type:"inputgroup",containerClassNames:"flex gap-2 ",classNames:"w-full",children:[{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"MM should only contain letters."}),component:"",defaultValue:"",slug:"mm",name:"MM",props:{placeholder:"MM"},type:"textinput"},{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"MM should only contain letters."}),component:"",defaultValue:"",slug:"yy",name:"YY",props:{placeholder:"YY"},type:"textinput"},{validator:d.z.string().min(5).refine(e=>/^[a-zA-Z]+$/.test(e),{message:"Code should only contain letters."}),component:"",defaultValue:"",slug:"code",name:"Code",props:{placeholder:"code"},type:"textinput"}]},{type:"inputgroup",containerClassNames:"flex gap-2 ",classNames:"",children:[{validator:d.z.string(),component:"",defaultValue:"",slug:"visa",name:"Visa",props:{children:(0,t.jsx)("img",{src:"/visa.png"})},type:"radio"},{validator:d.z.string(),component:"",defaultValue:"",slug:"master",name:"master",props:{children:(0,t.jsx)("img",{src:"/master-card.png"})},type:"radio"}]},{validator:d.z.string(),component:"",defaultValue:"",slug:"save",name:"save",props:{children:"Save card for easy checkout."},type:"checkbox"}],{formComponent:u,form:h,validate:f,getValues:g}=(0,o.B$)(n,"",[{check:e=>e.visa||e.master,ctx:{message:"Please select a payment provider",path:["visa"]}},{check:e=>!0,ctx:{message:"Please select a payment provider",path:["save"]}}]),j=(0,a.v9)(e=>e.cart.cart);(0,a.v9)(e=>{let s=Object.keys(j),l=[];for(let t=0;t<s.length;t++)e.cart.products.hasOwnProperty(s[t])&&l.push(e.cart.products[s[t]]);return l});let y=(0,o.B$)(x,"",[]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex-1 w-full",children:[(0,t.jsx)(p,{setSelectedCard:s,children:u}),(0,t.jsx)(v,{setSelectedBilling:r,children:y.formComponent})]}),(0,t.jsx)("div",{className:"max-w-[510px] min-w-[310px]",children:(0,t.jsx)(c,{title:"Place Order",onClick:()=>{console.log(e,l);let s={valid:!1,values:{}};return e&&l?(s.valid=!0,s.values={cc:e,address:l}):e&&null==l?y.validate()&&(s.valid=!0,s.values={cc:e,address:y.getValues()}):null==e&&l?f()&&(s.valid=!0,s.values={cc:g(),address:l}):!l&&!e&&f()&&y.validate()&&(s.valid=!0,s.values={cc:g(),address:y.getValues()}),console.log(s),s}})})]})}},5537:function(e,s,l){"use strict";var t=l(7437);s.Z=function(e){let{children:s,f:l,className:a,...r}=e,n=" ".concat((()=>{let e=[];return l&&(e.push("flex"),l.includes("h")&&e.push("items-center"),l.includes("v")&&e.push("justify-center"),l.includes("fc")&&e.push("flex-col"),l.includes("fr")&&e.push("flex-row")),e.join(" ")})()," ").concat(a||""," ");return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:" ".concat(n," "),...r,children:s})})}},2930:function(e,s,l){"use strict";var t=l(7437);let a=(0,l(2265).forwardRef)(function(e,s){return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:"",children:(0,t.jsx)("input",{className:"px-4 py-3 w-full rounded-lg ",ref:e.iref,...e})})})});function r(e){let{children:s,className:l,placeholder:a,...r}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("input",{className:l||"",placeholder:a||"",...r})})}s.Z=function(e){return(null==e?void 0:e.iref)?(0,t.jsx)(a,{...e}):(0,t.jsx)(r,{...e})}},6638:function(e,s,l){"use strict";var t=l(7437);s.Z=function(e){let{children:s,...l}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("li",{...l,children:s})})}},7858:function(e,s,l){"use strict";var t=l(7437);s.Z=function(e){let{children:s,...l}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("ul",{...l,children:s})})}},4518:function(e,s,l){"use strict";var t=l(7437),a=l(2930),r=l(5537),n=l(7858),i=l(6638);s.Z=function(e){var s,l;let{children:c,helper:o,...d}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(r.Z,{children:[(0,t.jsxs)(r.Z,{f:"frh",className:"gap-2 my-2",children:[(0,t.jsx)(a.Z,{type:"radio",iref:null==o?void 0:o.ref,onChange:null==o?void 0:o.onChange,...d}),c]}),Array.isArray(null==o?void 0:o.errors)&&(null==o?void 0:null===(s=o.errors)||void 0===s?void 0:s.length)>0?(0,t.jsx)(n.Z,{className:"flex-col m-1 text-sm text-red-700",children:(null==o?void 0:o.errors)&&(null==o?void 0:null===(l=o.errors)||void 0===l?void 0:l.map((e,s)=>(0,t.jsx)(i.Z,{className:"mt-1",children:e},"k-".concat(s))))}):null]})})}},5575:function(e,s,l){"use strict";var t=l(7437),a=l(5537),r=l(7858),n=l(6638),i=l(2930);s.Z=function(e){var s,l;let{children:c,type:o,placeholder:d,helper:u,...m}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(a.Z,{f:"c",className:"flex-col mb-6",children:[(0,t.jsx)(i.Z,{className:"px-4 py-3 w-full rounded-lg border",placeholder:d||"",iref:u.ref,...m,onBlur:u.onChange}),Array.isArray(null==u?void 0:u.errors)&&(null==u?void 0:null===(s=u.errors)||void 0===s?void 0:s.length)>0?(0,t.jsx)(r.Z,{className:"flex-col m-1 text-sm text-red-700",children:(null==u?void 0:u.errors)&&(null==u?void 0:null===(l=u.errors)||void 0===l?void 0:l.map((e,s)=>(0,t.jsx)(n.Z,{className:"mt-1",children:e},"k-".concat(s))))}):null]})})}},6463:function(e,s,l){"use strict";var t=l(1169);l.o(t,"useParams")&&l.d(s,{useParams:function(){return t.useParams}}),l.o(t,"usePathname")&&l.d(s,{usePathname:function(){return t.usePathname}}),l.o(t,"useRouter")&&l.d(s,{useRouter:function(){return t.useRouter}})},6934:function(e,s,l){"use strict";l.d(s,{B$:function(){return h},SL:function(){return x}});var t=l(7437),a=l(2265),r=l(9772),n=l(5575),i=l(4518),c=l(2930),o=l(5537),d=l(7858),u=l(6638),m=function(e){var s,l;let{children:a,helper:r,...n}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(o.Z,{children:[(0,t.jsxs)(o.Z,{f:"frh",className:"gap-2 my-2",children:[(0,t.jsx)(c.Z,{type:"checkbox",iref:r.ref,onChange:r.onChange,...n}),a]}),Array.isArray(null==r?void 0:r.errors)&&(null==r?void 0:null===(s=r.errors)||void 0===s?void 0:s.length)>0?(0,t.jsx)(d.Z,{className:"flex-col m-1 text-sm text-red-700",children:(null==r?void 0:r.errors)&&(null==r?void 0:null===(l=r.errors)||void 0===l?void 0:l.map((e,s)=>(0,t.jsx)(u.Z,{className:"mt-1",children:e},"k-".concat(s))))}):null]})})};let p=e=>{let{component:s,...l}=e;return"textinput"==s?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.Z,{...l})}):"radio"==s?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(i.Z,{...l})}):"checkbox"==s?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(m,{...l})}):(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.Z,{...l})})},v=(e,s)=>{let[l,t]=(0,a.useState)(null),[r,n]=(0,a.useState)([]),i=(0,a.useRef)(null),c=()=>{if(s){var e,l;let t=s.safeParse(i.current.value);return n((null==t?void 0:null===(l=t.error)||void 0===l?void 0:null===(e=l.format())||void 0===e?void 0:e._errors)||[]),(null==t?void 0:t.success)||!1}return!1};return Object.freeze({ref:i,onChange:e=>{c()&&t(e)},getValue:()=>{var e;return null==i?void 0:null===(e=i.current)||void 0===e?void 0:e.value},validate:c,validator:s,errors:r,setErrors:n})},x=(e,s)=>{let l=Object.keys(e),t=(()=>{let s={};return l.forEach(l=>{s[l]=v(l,e[l])}),s})();return{form:t,validate:()=>{let e={},s={};l.forEach(l=>{e[l]=t[l].getValue(),s[l]=t[l].validator,t[l].validate()});let a=r.z.object(s).safeParse(e);return(null==a?void 0:a.success)||!1},getValues:()=>{let e={};return l.forEach(s=>{e[s]=t[s].getValue()}),e}}},h=(e,s,l,a,n,i)=>{let c={},o=[],d=a?Object.keys(a):[];console.log(d),e.forEach(e=>{if("object"==typeof e&&"string"==typeof(null==e?void 0:e.slug)&&e.slug&&"inputgroup"!==e.type)c[e.slug]=v(e.slug,e.validator),d.includes(e.slug)&&(e.props.defaultValue=a[e.slug]),o.push((0,t.jsx)(p,{helper:c[e.slug],component:e.type,...e.props}));else if("inputgroup"==e.type){let s=[];e.children.forEach(e=>{!Array.isArray(e)&&"object"==typeof e&&"string"==typeof(null==e?void 0:e.slug)&&e.slug&&(c[e.slug]=v(e.slug,e.validator),d.includes(e.slug)&&(e.props.defaultValue=a[e.slug]),s.push((0,t.jsx)(p,{helper:c[e.slug],component:e.type,...e.props})))}),o.push((0,t.jsx)("div",{className:e.containerClassNames,children:s.map((s,l)=>(0,t.jsx)("div",{className:e.classNames,children:s},"k-".concat(l)))}))}});let u=(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl my-6",children:s}),(0,t.jsxs)("form",{children:[o.map((e,s)=>(0,t.jsx)("div",{children:e},"k-".concat(s))),(0,t.jsxs)("div",{className:"flex justify-end gap-4",children:[n&&(0,t.jsx)("button",{className:"border px-6 py-3 rounded-full",onClick:n,children:"Cancel"}),i&&(0,t.jsx)("button",{className:"border px-6 py-3 rounded-full",onClick:()=>{i(m())},children:"Submit"})]})]})]}),m=()=>{let e=Object.keys(c),s={};return e.forEach(e=>{s[e]=c[e].getValue()}),s};return{formComponent:u,form:c,validate:()=>{var e;let s=Object.keys(c),t={},a={};s.forEach(e=>{t[e]=c[e].getValue(),a[e]=c[e].validator,c[e].validate()});let n=r.z.object(a);l.forEach(e=>{n=n.refine(e.check,e.ctx)});let i=n.safeParse(t),o=null==i?void 0:null===(e=i.error)||void 0===e?void 0:e.format();return s.forEach(e=>{if(null==o?void 0:o.hasOwnProperty(e)){var s;c[e].setErrors((null===(s=o[e])||void 0===s?void 0:s._errors)||[])}}),(null==i?void 0:i.success)||!1},getValues:m}}},724:function(e,s,l){"use strict";l.d(s,{w:function(){return r}});var t=l(6463),a=l(1444);let r=function(){var e;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,l=(0,t.usePathname)(),r=(0,a.v9)(e=>{var s;return(null==e?void 0:null===(s=e.base)||void 0===s?void 0:s.url)||""});if(s<1)return r;let n=null==l?void 0:null===(e=l.split("/"))||void 0===e?void 0:e.filter(e=>(null==e?void 0:e.trim())!="");return n.length<1?r:"".concat(r,"/").concat(n[0])}}},function(e){e.O(0,[1444,928,9772,8771,2971,7023,1744],function(){return e(e.s=8801)}),_N_E=e.O()}]);